<template component="grammar-popup">
  <div
    class="fixed max-w-4xl mx-auto left-0 right-0 w-full flex flex-col overflow-hidden overflow-y-scroll z-50 transition-transform duration-300 ease-in-out border bg-white shadow-lg rounded-lg"
    class-feedback-open="feedbackOpen"
    class-feedback-closed="!feedbackOpen"
  >
    <div
      class="flex items-center justify-between px-6 pt-5 pb-4 border-b flex-1"
    >
      <h2 class="text-lg font-bold">Feedback</h2>
      <button on-click="toggleFeedback()" class="flex items-center space-x-2">
        <lucide-icon
          icon="chevron-up"
          class="transform transition-transform duration-300 ease-in-out"
          class-rotate-180="feedbackOpen"
        ></lucide-icon>
      </button>
    </div>

    <div class="p-6 h-full">
      <grammar-results class="block mb-4"></grammar-results>
      <grammar-feedback></grammar-feedback>
    </div>
  </div>

  <script setup>
    import { load, defineProp } from "@li3/web";
    import useStore from "@/store.js";

    export default function () {
      const { select, store } = useStore();

      const text = select((s) => s.text);
      const results = select((s) => s.results);
      const checking = select((s) => s.checking);
      const feedbackOpen = select((s) => s.feedbackOpen);

      const { toggleFeedback } = store;

      return { results, checking, text, toggleFeedback, feedbackOpen };
    }
  </script>
  <style>
    .feedback-open {
      transform: translateY(-100%);
    }
    .feedback-closed {
      transform: translateY(-24px);
    }
  </style>
</template>
