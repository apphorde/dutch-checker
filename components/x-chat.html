<template component="x-chat">
  <script setup>
    import { defineEvent, signal } from "@li3/web";

    export default function () {
      const input = signal("");
      const emit = defineEvent("submit");

      const handleSubmit = (e) => {
        emit(input.value);
        setInput("");
      };

      const handleKeyDown = (e) => {
        if (e.key === "Enter" && !e.shiftKey) {
          e.preventDefault();
          handleSubmit(e);
        }
      };
    }
  </script>

  <div
    class="ring-none mx-auto flex h-svh max-h-svh w-full max-w-[35rem] flex-col items-stretch border-none"
  >
    <div class="flex-1 content-center overflow-y-auto px-6">
      <template if="!messages.length">
        <header class="m-auto flex max-w-96 flex-col gap-5 text-center">
          <h1 class="text-2xl font-semibold leading-none tracking-tight">
            It's quiet here...
          </h1>
          <p class="text-muted-foreground text-sm">Let's start a new chat!</p>
        </header>
      </template>
    </div>
    <form
      on-submit.prevent="handleSubmit()"
      class="border-input bg-background focus-within:ring-ring/10 relative mx-6 mb-6 flex items-center rounded-[16px] border px-3 py-1.5 pr-8 text-sm focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-0"
    >
      <textarea
        on-keydown="handleKeyDown($event)"
        on-change="setInput($event)"
        bind-value="input"
        placeholder="Enter a message"
        class="placeholder:text-muted-foreground flex-1 bg-transparent focus:outline-none"
      ></textarea>
      <button type="submit">submit</button>
    </form>
  </div>
</template>
